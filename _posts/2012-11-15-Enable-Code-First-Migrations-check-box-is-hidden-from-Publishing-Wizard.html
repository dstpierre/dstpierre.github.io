---
layout: post
title: Enable Code First Migrations check box is hidden from Publishing Wizard
date: 2012-11-15 10:25:08 UTC
updated: 2012-11-15 10:25:08 UTC
comments: false
categories: Windows Azure
---

<p>I’ve been really excited with the new Windows Azure Websites recently. As a long time <a href="http://www.appharbor.com" target="_blank">AppHarbor</a> user, deploying ASP.NET MVC app to the cloud via a git push is extremely nice.</p> <p>Something strange happened to me on my last project though. After creating a basic working prototype of the app I was ready to deploy the application. Since it’s a small prototype for now I was using the Visual Studio Publishing Wizard.</p> <p>I had enable migrations on the project, created some models and my <a href="http://msdn.microsoft.com/en-us/library/system.data.entity.dbcontext(v=vs.103).aspx" target="_blank">DbContext</a> class, everything was working nicely. On the Publishing Wizard I was seeing this:</p> <p><a href="http://lh5.ggpht.com/-pjCziYSZrpY/UKTC90YFo4I/AAAAAAAAACc/RlLsJhAgCz0/s1600-h/without-code-first%25255B6%25255D.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="without-code-first" border="0" alt="without-code-first" src="http://lh4.ggpht.com/-Rvvg9QODMH0/UKTC-TOiumI/AAAAAAAAACk/Eohz93NivBM/without-code-first_thumb%25255B4%25255D.png?imgmax=800" width="621" height="484"></a> </p> <p>The <strong>Enable Code First Migrations</strong> check box was not present, and my DbContext class was not displayed. The wizard should look like this:</p> <p><a href="http://lh4.ggpht.com/-VtLBsM6qjGw/UKTC-9KYajI/AAAAAAAAACs/PM-Of2JRNnU/s1600-h/with-code-first%25255B4%25255D.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="with-code-first" border="0" alt="with-code-first" src="http://lh6.ggpht.com/-Y50JPeH4Wiw/UKTC_v8HqtI/AAAAAAAAAC0/q24nNM4Llgs/with-code-first_thumb%25255B2%25255D.png?imgmax=800" width="615" height="613"></a> </p> <p>After a couple of time (hours?) of digging, I finally find where the thing is configured.</p> <p><a href="http://lh4.ggpht.com/-8QOfC4nJhSU/UKTDADEfUaI/AAAAAAAAAC8/UAtsGru-COM/s1600-h/publish-settings%25255B3%25255D.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="publish-settings" border="0" alt="publish-settings" src="http://lh4.ggpht.com/-2wBfQDRvPyo/UKTDA2fQPjI/AAAAAAAAADE/FB6NTKF3060/publish-settings_thumb%25255B1%25255D.png?imgmax=800" width="331" height="246"></a> </p> <p>&nbsp;</p> <h3>Manually editing the pubxml file to make the check box appear</h3> <p>You can enable that check box by editing the Properties\YourProject - WebDeploy.pubxml look for the PublishDatabaseSettings<pre class="csharpcode"><span class="kwrd">&lt;</span><span class="html">PublishDatabaseSettings</span><span class="kwrd">&gt;</span><br />  <span class="kwrd">&lt;</span><span class="html">Objects</span> <span class="attr">xmlns</span><span class="kwrd">=""</span><span class="kwrd">&gt;</span><br />    <span class="kwrd">&lt;</span><span class="html">ObjectGroup</span> <span class="attr">Name</span><span class="kwrd">="Namespace.Models.YourDBClass"</span> <span class="attr">Order</span><span class="kwrd">="1"</span> <span class="attr">Enabled</span><span class="kwrd">="True"</span><span class="kwrd">&gt;</span><br />      <span class="kwrd">&lt;</span><span class="html">Destination</span> <span class="attr">Path</span><span class="kwrd">="your-connection-string-goes-here"</span> <span class="kwrd">/&gt;</span><br />      <span class="kwrd">&lt;</span><span class="html">Object</span> <span class="attr">Type</span><span class="kwrd">="DbCodeFirst"</span><span class="kwrd">&gt;</span><br />        <span class="kwrd">&lt;</span><span class="html">Source</span> <span class="attr">Path</span><span class="kwrd">="DBMigration"</span> <span class="attr">DbContext</span><span class="kwrd">="Namespace.Models.YourDBClass, AssamblyName"</span> <span class="attr">MigrationConfiguration</span><span class="kwrd">="Namespace.Migrations.Configuration, Assambly"</span> <span class="attr">Origin</span><span class="kwrd">="Convention"</span> <span class="kwrd">/&gt;</span><br />      <span class="kwrd">&lt;/</span><span class="html">Object</span><span class="kwrd">&gt;</span><br />    <span class="kwrd">&lt;/</span><span class="html">ObjectGroup</span><span class="kwrd">&gt;</span><br />  <span class="kwrd">&lt;/</span><span class="html">Objects</span><span class="kwrd">&gt;</span><br /><span class="kwrd">&lt;/</span><span class="html">PublishDatabaseSettings</span><span class="kwrd">&gt;</span></pre><br /><p>Change Namespace.Models.YourDBClass by your class that inherits DbContext, change Namespace.Migratins.Configuration to fit your migration configuration namespace and Assambly with your Assambly name.<br /><p>Save and open the publish wizard you will have that check box.<br /><p>I’ve took the VS Publishing Wizard from <a href="http://stackoverflow.com/questions/13230902/publishing-my-database-package-deploy-with-code-first-migrations/13388315#13388315" target="_blank">that stackoverflow question</a> I’ve answered.<br /><p></p><br /><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:0767317B-992E-4b12-91E0-4F059A8CECA8:df95313c-fa1b-43b9-9c70-8918419bda98" class="wlWriterEditableSmartContent">Technorati Tags: <a href="http://technorati.com/tags/Windows+Azure" rel="tag">Windows Azure</a>,<a href="http://technorati.com/tags/Publishing+Wizard" rel="tag">Publishing Wizard</a>,<a href="http://technorati.com/tags/EF+Code+First+Migrations" rel="tag">EF Code First Migrations</a></div>  